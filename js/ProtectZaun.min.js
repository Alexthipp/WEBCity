const GAME_STAGE_WIDTH=1e3,GAME_STAGE_HEIGHT=700;let game,wfConfig={active:function(){startGame()},google:{families:["Rammetto One","Sniglet","Indie Flower","Black Ops One","Press Start 2P"]}};function startGame(){game=new Phaser.Game(1e3,700,Phaser.CANVAS,"gamestage"),game.state.add("startScreen",startState),game.state.add("selectPart",selectState),game.state.add("settings",settingsState),game.state.add("instructions",insState),game.state.add("partA",playAState),game.state.add("partB",playBState),game.state.add("endScreen",endState),game.state.start("startScreen")}WebFont.load(wfConfig);const BUTTON_OFFSETY_BETWEEN=100,BUTTON_OFFSET_WIDTH=102,BUTTON_OFFSET_HEIGHT=37,TEXT_OFFSET_VER=125,TEXT_OFFSET_HOR=500;let startState={preload:preloadStart,create:createStart},result="WIN",score,stateName,numThreads=3,controls="keyboard",linkCharacter="assets/imgs/jinx.png",linkBulletSound="assets/snds/jinxShoot.wav",linkBulletPng="assets/imgs/spritesheetBulletJinx.png",linkBulletJson="assets/jsons/spritesheetBulletJinx.json",animbulletvelocity=44,time,threadDistance=250,threadsArray=[250,500,750],musicNP,btnSnd,msplaying=!1;function preloadStart(){game.load.image("background","../assets/imgs/Background.png"),game.load.image("play","assets/imgs/button_play.png"),game.load.image("settings","assets/imgs/button_settings.png"),game.load.image("instructions","assets/imgs/button_instructions.png"),game.load.audio("bckmusic","assets/snds/backgroundMusicNotPlaying.mp3"),game.load.audio("bttnSnd","assets/snds/Button.wav")}function createStart(){let bg;time=0,score=0,msplaying||(musicNP=game.sound.add("bckmusic",.05,!0),msplaying=!0,musicNP.play()),btnSnd=game.sound.add("bttnSnd",.05),game.add.sprite(0,0,"background").scale.setTo(.5,.5);let posX=398,posY=313;btnPlay=game.add.button(398,213,"play",clickPlay),btnInst=game.add.button(398,313,"instructions",clickInstrunctions),btnStt=game.add.button(398,413,"settings",clickSettings);let textC="Credits:\n";textC+="Alejandro Toro Urdaneta\n",textC+="Jesus Huguet Orosia";let styleC={font:"Indie Flower",fontSize:"24px",fontStyle:"bold",fill:"#FFC100",align:"center"},credits;game.add.text(game.world.width/2,game.world.height-125,textC,styleC).anchor.setTo(.5,.5)}function clickPlay(){btnSnd.play(),game.state.start("selectPart")}function clickInstrunctions(){btnSnd.play(),game.state.start("instructions")}function clickSettings(){btnSnd.play(),game.state.start("settings")}let selectState={preload:preloadSelect,create:createSelect};function preloadSelect(){game.load.image("background","assets/imgs/Background.png"),game.load.image("pA","assets/imgs/button_parta.png"),game.load.image("pB","assets/imgs/button_partb.png"),game.load.image("pC","assets/imgs/button_partc.png"),game.load.audio("bckmusic","assets/snds/backgroundMusicNotPlaying.mp3")}function createSelect(){let bg;game.add.sprite(0,0,"background").scale.setTo(.5,.5);let posX=398,posY=313;btnPartA=game.add.button(398,213,"pA",onButtonPressed),btnPartB=game.add.button(398,313,"pB",onButtonPressed)}function onButtonPressed(button){button===btnPartA?(musicNP.stop(),msplaying=!1,game.state.start("partA")):button===btnPartB&&(musicNP.stop(),msplaying=!1,game.state.start("partB"))}let insState={preload:preloadInst,create:createInst};function preloadInst(){game.load.image("background","assets/imgs/Background.png"),game.load.image("back","assets/imgs/button_back.png"),game.load.image("keys","assets/imgs/keys.png"),game.load.image("spacebar","assets/imgs/spacebar.png"),game.load.image("mouse","assets/imgs/mouse.png"),game.load.image("clickedmouse","assets/imgs/clickedmouse.png"),game.load.audio("bttnSnd","assets/snds/Button.wav")}function createInst(){let bg;game.add.sprite(0,0,"background").scale.setTo(.5,.5),btnSnd=game.sound.add("bttnSnd",.05);let insStyle={font:"Indie Flower",fontSize:"24px",fontStyle:"bold",fill:"#FFC100",align:"center"},instText="Shoot the bombs falling along the threads, move from thread to thread\n",inst;instText+="Life items can appear throughout the game,collect them to survive\n",instText+="If a bomb touches you or hits the ground you`ll lose life\n",instText+="If you run out of life, you lose the game\n",instText+="If you manage to survive and eliminate the highest number of bombs, you win.",game.add.text(500,140,instText,insStyle).anchor.setTo(.5,.5);let move=game.add.text(250,262.5,"Move",insStyle),keys=game.add.sprite(200,350,"keys");keys.anchor.setTo(.5,.5),keys.scale.setTo(1,1);let mse=game.add.sprite(400,350,"mouse");mse.anchor.setTo(.5,.5),mse.scale.setTo(.75,.75);let shoot=game.add.text(750,262.5,"shoot",insStyle),spcbar=game.add.sprite(1e3/1.5,350,"spacebar");spcbar.anchor.setTo(.5,.5),spcbar.scale.setTo(1,1);let clkmse=game.add.sprite(1e3/1.2,350,"clickedmouse");clkmse.anchor.setTo(.5,.5),clkmse.scale.setTo(.5,.5);let posX=398,posY=313;btnbck=game.add.button(398,513,"back",clickBack)}let settingsState={preload:preloadSettings,create:createSettings},textNum,btnKeybd,btnMouse,btnJinx,btnZoe;function preloadSettings(){game.load.image("background","assets/imgs/Background.png"),game.load.image("back","assets/imgs/button_back.png"),game.load.image("plus","assets/imgs/button_plus.png"),game.load.image("menus","assets/imgs/button_menus.png"),game.load.image("kbd","assets/imgs/button_keyboard.png"),game.load.image("mouse","assets/imgs/button_mouse.png"),game.load.image("jinx","assets/imgs/button_jinx.png"),game.load.image("zoe","assets/imgs/button_zoe.png"),game.load.audio("bttnSnd","assets/snds/Button.wav")}let styleT={font:"25px Arial",fill:"#FF0000"};function createSettings(){let bg;game.add.sprite(0,0,"background").scale.setTo(.5,.5),btnSnd=game.sound.add("bttnSnd",.05);let posX=398,posY=313;btnbck=game.add.button(posX,posY+200,"back",clickBack);let textT="Threads number: \n\n\n";textT+="Controls: \n\n\n",textT+="Character: ";let textThreads=game.add.text(250,175,textT,styleT);posX=500,posY=175,btnPlus=game.add.button(posX+50,posY-10,"plus",modNumberThreads),btnPlus.scale.setTo(.75,.75),btnMenus=game.add.button(posX-50,posY-10,"menus",modNumberThreads),btnMenus.scale.setTo(.75,.75),textNum=game.add.text(525,175,numThreads,styleT),btnKeybd=game.add.button(posX-120,posY+50,"kbd",controlSelection),btnMouse=game.add.button(posX+100,posY+50,"mouse",controlSelection),btnJinx=game.add.button(posX-120,posY+150,"jinx",characterSelection),btnZoe=game.add.button(posX+100,posY+150,"zoe",characterSelection),"keyboard"==controls?(btnKeybd.alpha=1,btnMouse.alpha=.5):(btnKeybd.alpha=.5,btnMouse.alpha=1),"assets/imgs/jinx.png"==linkCharacter?(btnJinx.alpha=1,btnZoe.alpha=.5):(btnJinx.alpha=.5,btnZoe.alpha=1)}function clickBack(){btnSnd.play(),game.state.start("startScreen")}function modNumberThreads(button){button===btnPlus&numThreads<9?numThreads+=1:button===btnMenus&numThreads>3&&(numThreads-=1),textNum.text=numThreads.toString(),threadsArray=[];let offsetPosition=1e3/(numThreads+1);for(let pos=0;pos<numThreads;pos++)threadsArray.push(offsetPosition*(pos+1));threadDistance=threadsArray[1]-threadsArray[0]}function controlSelection(button){button===btnKeybd?(controls="keyboard",btnMouse.alpha=.5,btnMouse.input.enable=!0,btnKeybd.alpha=1,btnKeybd.input.enable=!1):(controls="mouse",btnMouse.alpha=1,btnMouse.input.enable=!1,btnKeybd.alpha=.5,btnKeybd.input.enable=!0)}function characterSelection(button){button===btnJinx?(linkCharacter="assets/imgs/Jinx.png",linkBulletPng="assets/imgs/spritesheetBulletJinx.png",linkBulletJson="assets/jsons/spritesheetBulletJinx.json",linkBulletSound="assets/snds/jinxShoot.wav",animbulletvelocity=44,btnJinx.alpha=1,btnZoe.alpha=.5):(linkCharacter="assets/imgs/Zoe.png",linkBulletPng="assets/imgs/spritesheetBulletZoe.png",linkBulletJson="assets/jsons/spritesheetBulletZoe.json",linkBulletSound="assets/snds/zoeShoot.mp3",animbulletvelocity=23,btnJinx.alpha=.5,btnZoe.alpha=1)}class Character{constructor(pos,sprite,health){this.position=pos,this.chSprite=sprite,this.chSprite.x=threadsArray[this.position],this.chSprite.y=575,this.health=health}move(direction){"left"==direction&&this.position>0?(this.chSprite.x=threadsArray[this.position-1],this.position-=1,character.chSprite.scale.x*=-1):"right"==direction&&this.position<threadsArray.length-1&&(this.chSprite.x=threadsArray[this.position+1],this.position+=1,character.chSprite.scale.x*=-1)}}const HUD_HEIGHT=50,BULLETS_GROUP_SIZE=40,ENEMIES_GROUP_SIZE=200,TIMER_RHYTHM=1.5*Phaser.Timer.SECOND,NUM_LEVELS=3,LEVEL_BOMBS_PROBABILITY=[.4,1.2,2],LEVEL_BOMBS_VELOCITY_A=[70,140,250],LEVEL_BOMBS_VELOCITY_B=[70,140,200],LEVEL_ENEMIES=[10,20,40],HITS_FOR_LEVEL_CHANGE=15;let cursors,fireButton,bulletTime=0,offsetTimeToFire=500,character,bombs,honeys,bullets,explotion,healthBar,enemiesCreated,enemiesDestroyed,healthProbability,currentBombProbability,currentBombVelocity,ground,scoreText,level,levelText,timeText,lives,livesText,health,music,bulletSound,explotionSound,healtSound,playAState={preload:preloadPartA,create:createPartA,update:updatePartA};function preloadPartA(){game.load.image("ground","assets/imgs/Ground.png"),game.load.image("plus","assets/imgs/button_plus.png"),game.load.image("thread","../assets/imgs/Thread.png"),game.load.image("border","../assets/imgs/BorderHealthbar.png"),game.load.image("character",linkCharacter),game.load.atlasJSONHash("honey","assets/imgs/spritesheetHoneyfruit.png","assets/jsons/spritesheetHoneyfruit.json"),game.load.atlasJSONHash("bullet",linkBulletPng,linkBulletJson),game.load.atlasJSONHash("bomb","../assets/imgs/spritesheetBomb.png","../assets/jsons/spritesheetBomb.json"),game.load.atlasJSONHash("expl","assets/imgs/spritesheetExplotion.png","assets/jsons/spritesheetExplotion.json"),game.load.atlasJSONHash("background","assets/imgs/spritesheetBackground.png","assets/jsons/spritesheetBackground.json"),game.load.atlasJSONHash("health","assets/imgs/spritesheetHealthBar.png","assets/jsons/spritesheetHealthbar.json"),game.load.audio("bckmusic","assets/snds/backgroundMusicPlaying.mp3"),game.load.audio("shoot",linkBulletSound),game.load.audio("explSnd","assets/snds/Explotion.wav"),game.load.audio("healthSnd","assets/snds/health.wav"),game.load.audio("movingSnd","assets/snds/moving.wav")}function createPartA(){stateName="partA",level=1,health=100,enemiesCreated=0,enemiesDestroyed=0,healthProbability=.2;let bg=game.add.sprite(0,0,"background");bg.scale.setTo(2,2),bg.animations.add("Idle",Phaser.Animation.generateFrameNames("Background",1,59,"",1,59),7,!0,!1),bg.animations.play("Idle"),createKeyControls(),createBullets(40),createThreads(),createBombs(200),createHealthItem(200),createExplotions(200),createCharacter(),createHUD(),createSounds(),ground=game.add.sprite(0,655,"ground"),game.physics.enable(ground,Phaser.Physics.ARCADE)}function updatePartA(){manageCharacterMovement(),manageShots(),game.physics.arcade.overlap(bullets,bombs,bulletHitsBomb,null,this),game.physics.arcade.overlap(honeys,character.chSprite,healthHitsCharacter,null,this),game.physics.arcade.overlap(bombs,ground,bombHitsGround,null,this),game.physics.arcade.overlap(bombs,character.chSprite,bombHitsGround,null,this),game.physics.arcade.overlap(honeys,ground,healthHitsGround,null,this)}function createCharacter(){let theCharacter=game.add.sprite(0,0,"character");theCharacter.anchor.setTo(.5,.5),theCharacter.scale.setTo(.14,.14),game.physics.enable(theCharacter,Phaser.Physics.ARCADE),character=new Character(0,theCharacter,200)}function manageCharacterMovement(){"mouse"==controls?game.input.speed.x<0&&game.input.mousePointer.x<character.chSprite.x-threadDistance/2?(character.move("left"),movingSound.play()):game.input.speed.x>0&&game.input.mousePointer.x>character.chSprite.x+threadDistance/2&&(character.move("right"),movingSound.play()):"keyboard"==controls&&(cursors.left.justDown?(character.move("left"),movingSound.play()):cursors.right.justDown&&(character.move("right"),movingSound.play()))}function createKeyControls(){cursors=game.input.keyboard.createCursorKeys(),"keyboard"==controls?fireButton=game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR):"mouse"==controls&&(fireButton=game.input.mousePointer.leftButton)}function manageShots(){"keyboard"===controls&&fireButton.justDown?game.time.now>bulletTime&&(bulletSound.play(),fireBullet(),bulletTime=game.time.now+offsetTimeToFire):"mouse"===controls&&fireButton.justPressed(20)&&game.time.now>bulletTime&&(bulletSound.play(),fireBullet(),bulletTime=game.time.now+offsetTimeToFire)}function createHUD(){let scoreX=5,levelX=game.world.width/2,livesX=game.world.width-125,allY=25,styleHUD={font:"Press Start 2P",fontStyle:"bold",fontSize:"16px",align:"center",fill:"#A200FF"};scoreText=game.add.text(5,25,"Score:"+score,styleHUD),levelText=game.add.text(levelX,25,stateName+" Level: "+level,styleHUD),levelText.anchor.setTo(.5,0),timeText=game.add.text(levelX,50,setTime(time),styleHUD),timeText.anchor.setTo(.5,0),healthBar=game.add.sprite(livesX,25,"health"),healthBar.animations.add("Lives",Phaser.Animation.generateFrameNames("Healthbar",1,6,"",1,6),6,!0,!1),healthBar.animations.play("Lives");let border=game.add.sprite(livesX,25,"border");livesText=game.add.text(livesX+50,25,health,styleHUD),game.time.events.loop(Phaser.Timer.SECOND,updateTime,this)}function updateLifeBar(){healthBar.scale.setTo(health/100,1)}function updateTime(){time+=1,timeText.text=setTime(time)}function setTime(seconds){return String(Math.trunc(seconds/60)).padStart(2,"0")+":"+String(Math.floor(seconds%60)).padStart(2,"0")}function createThreads(){for(i=0;i<threadsArray.length;i++){let thread;game.add.sprite(threadsArray[i]-35,0,"thread").scale.setTo(1,.74)}}function createBullets(number){bullets=game.add.group(),bullets.enableBody=!0,bullets.createMultiple(number,"bullet"),bullets.callAll("events.onOutOfBounds.add","events.onOutOfBounds",resetMember),bullets.callAll("anchor.setTo","anchor",0,1),bullets.setAll("checkWorldBounds",!0)}function fireBullet(){let x,y,v,bullet=shootBullet(character.chSprite.x-5,character.chSprite.y-50,-250)}function shootBullet(x,y,velocity){let bullet=bullets.getFirstExists(!1);return bullet&&(bullet.reset(x,y),bullet.scale.setTo(.15,.25),bullet.body.velocity.y=velocity,bullet.animations.add("shoot",Phaser.Animation.generateFrameNames("Bullet",1,23,"",1,22),animbulletvelocity,!0,!1),bullet.animations.play("shoot")),bullet}function createBombs(number){bombs=game.add.group(),bombs.enableBody=!0,bombs.createMultiple(number,"bomb"),bombs.callAll("anchor.setTo","anchor",.5,1),currentBombProbability=LEVEL_BOMBS_PROBABILITY[level-1],"partA"===stateName?currentBombVelocity=LEVEL_BOMBS_VELOCITY_A[level-1]:"partB"===stateName&&(currentBombVelocity=LEVEL_BOMBS_VELOCITY_B[level-1]),game.time.events.loop(TIMER_RHYTHM,activateBomb,this)}function activateBomb(){if(Math.random()<currentBombProbability&&enemiesCreated<LEVEL_ENEMIES[level-1]){let bomb=bombs.getFirstExists(!1);if(bomb){let x=pickARandom(),y=0;bomb.reset(x,y),bomb.scale.setTo(.1,.1),bomb.body.velocity.y=currentBombVelocity,bomb.animations.add("bombAnimation",Phaser.Animation.generateFrameNames("Bomb",1,2,"",1,2),4,!0,!1),bomb.animations.play("bombAnimation"),enemiesCreated++}}}function createExplotions(number){explotions=game.add.group(),explotions.createMultiple(number,"expl"),explotions.forEach(setupExplotion,this)}function setupExplotion(explotion){explotion.scale.setTo(.25,.25),explotion.anchor.x=.5,explotion.anchor.y=.5,explotion.animations.add("exploit",Phaser.Animation.generateFrameNames("Explotion",1,17,"",1,17),17,!1,!1)}function displayExplotion(bomb){let explotion=explotions.getFirstExists(!1);if(explotion){let x=bomb.body.center.x,y=bomb.body.center.y;explotion.reset(x,y),explotion.animations.play("exploit")}}function createHealthItem(number){honeys=game.add.group(),honeys.enableBody=!0,honeys.createMultiple(number,"honey"),honeys.callAll("anchor.setTo","anchor",.63,1),honeys.callAll("events.onOutOfBounds.add","events.onOutOfBounds",resetMember),honeys.setAll("checkWorldBounds",!0)}function displayHealthItem(){let honey=honeys.getFirstExists(!1);if(honey){let x=pickARandom();honey.reset(x,0),honey.scale.setTo(.1,.1),honey.body.velocity.y=70,honey.animations.add("honeyAnimation",Phaser.Animation.generateFrameNames("Honeyfruit",1,7,"",1,7),7,!0,!1),honey.animations.play("honeyAnimation")}}function resetMember(item){item.kill()}function pickARandom(){let rnd=Math.floor(Math.random()*threadsArray.length);return threadsArray[rnd]+25}function continueGame(){cursors.left.reset(),cursors.right.reset(),currentBombProbability=LEVEL_BOMBS_PROBABILITY[level-1]}function endGame(){music.stop(),result="LOSE",game.state.start("endScreen")}function checkGameA(){level<3&&enemiesDestroyed==LEVEL_ENEMIES[level-1]?(level++,levelText.text=stateName+" Level: "+level,currentBombProbability=LEVEL_BOMBS_PROBABILITY[level-1],currentBombVelocity=LEVEL_BOMBS_VELOCITY_A[level-1]):3==level&&enemiesDestroyed==LEVEL_ENEMIES[level-1]&&(music.stop(),game.state.start("partB"))}function bulletHitsBomb(bullet,bomb){bullet.kill(),bomb.kill(),enemiesDestroyed++,Math.random()<healthProbability&&displayHealthItem(),displayExplotion(bomb),explotionSound.play(),score++,scoreText.text="Score:"+score,"partA"==stateName?checkGameA():"partB"==stateName&&checkGameB()}function healthHitsCharacter(character,honey){honey.kill(),healtSound.play(),0<health&&health<=60?health+=40:100>=health&&health>60&&(health=100),livesText.text=health,updateLifeBar()}function bombHitsGround(ground,bomb){if(displayExplotion(bomb),explotionSound.play(),bomb.kill(),enemiesDestroyed++,health-=20,livesText.text=health,updateLifeBar(),health<=0){let explotion=explotions.getFirstExists(!1);explotion&&(explotion.reset(500,350),explotion.scale.setTo(1.25,1.25),explotion.animations.play("exploit")),bombs.forEach(resetMember,this),character.chSprite.kill(),game.input.enabled=!1,game.time.events.add(2500,endGame,this)}else"partA"==stateName?checkGameA():"partB"==stateName&&checkGameB()}function healthHitsGround(ground,honey){honey.kill()}function createSounds(){music=game.sound.add("bckmusic",.07,!0),music.play(),bulletSound=game.sound.add("shoot",.4),explotionSound=game.sound.add("explSnd",.6),healtSound=game.sound.add("healthSnd",.4),movingSound=game.sound.add("movingSnd",.25)}let playBState={preload:preloadPartB,create:createPartB,update:updatePartB};const LEVEL_HEALTH=[.2,.1,.05],LEVEL_PROPABILITY_PORTALS=[.2,.4,.5];let bluePoint,blueDestination,redPoint,redDestination,greenPoint,greenDestination,yellowPoint,yellowDestination,teport;function preloadPartB(){game.load.image("ground","assets/imgs/Ground.png"),game.load.image("plus","assets/imgs/button_plus.png"),game.load.image("thread","../assets/imgs/Thread.png"),game.load.image("border","../assets/imgs/BorderHealthbar.png"),game.load.image("character",linkCharacter),game.load.atlasJSONHash("honey","assets/imgs/spritesheetHoneyfruit.png","assets/jsons/spritesheetHoneyfruit.json"),game.load.atlasJSONHash("bullet",linkBulletPng,linkBulletJson),game.load.atlasJSONHash("bomb","../assets/imgs/spritesheetBomb.png","../assets/jsons/spritesheetBomb.json"),game.load.atlasJSONHash("expl","assets/imgs/spritesheetExplotion.png","assets/jsons/spritesheetExplotion.json"),game.load.atlasJSONHash("background","assets/imgs/spritesheetBackground.png","assets/jsons/spritesheetBackground.json"),game.load.atlasJSONHash("bluePortal","/assets/imgs/spritesheetBlueCheckpoint.png","assets/jsons/spritesheetBlueCheckpoint.json"),game.load.atlasJSONHash("redPortal","/assets/imgs/spritesheetRedCheckpoint.png","assets/jsons/spritesheetRedCheckpoint.json"),game.load.atlasJSONHash("greenPortal","/assets/imgs/spritesheetGreenCheckpoint.png","assets/jsons/spritesheetGreenCheckpoint.json"),game.load.atlasJSONHash("yellowPortal","/assets/imgs/spritesheetYellowCheckpoint.png","assets/jsons/spritesheetYellowCheckpoint.json"),game.load.atlasJSONHash("health","assets/imgs/spritesheetHealthBar.png","assets/jsons/spritesheetHealthbar.json"),game.load.audio("bckmusic","assets/snds/backgroundMusicPlaying.mp3"),game.load.audio("shoot",linkBulletSound),game.load.audio("explSnd","assets/snds/Explotion.wav"),game.load.audio("healthSnd","assets/snds/health.wav"),game.load.audio("teleport","assets/snds/tp.wav"),game.load.audio("movingSnd","assets/snds/moving.wav")}function createPartB(){stateName="partB",level=1,health=100,enemiesCreated=0,enemiesDestroyed=0,healthProbability=LEVEL_HEALTH[level-1];let bg=game.add.sprite(0,0,"background");bg.scale.setTo(2,2),bg.animations.add("Idle",Phaser.Animation.generateFrameNames("Background",1,59,"",1,59),7,!0,!1),bg.animations.play("Idle"),teport=game.sound.add("teleport",.2),createKeyControls(),createThreads(),createPortals(),createBullets(40),createBombs(200),createHealthItem(200),createExplotions(200),createCharacter(),createHUD(),createSounds(),ground=game.add.sprite(0,655,"ground"),game.physics.enable(ground,Phaser.Physics.ARCADE)}function updatePartB(){manageCharacterMovement(),manageShots(),game.physics.arcade.overlap(bullets,bombs,bulletHitsBomb,null,this),game.physics.arcade.overlap(honeys,character.chSprite,healthHitsCharacter,null,this),game.physics.arcade.overlap(bombs,ground,bombHitsGround,null,this),game.physics.arcade.overlap(bombs,character.chSprite,bombHitsGround,null,this),game.physics.arcade.overlap(bluePoint,bombs,teletrasnportBomb,null,this),game.physics.arcade.overlap(redPoint,bombs,teletrasnportBomb,null,this),game.physics.arcade.overlap(greenPoint,bombs,teletrasnportBomb,null,this),game.physics.arcade.overlap(yellowPoint,bombs,teletrasnportBomb,null,this)}function createPortals(){bluePoint=game.add.sprite(threadsArray[0]+25,50,"bluePortal"),bluePoint.animations.add("bluePoint",Phaser.Animation.generateFrameNames("Bluecheckpoint",1,5,"",1,5),2,!0,!1),bluePoint.animations.play("bluePoint"),bluePoint.scale.setTo(.08,.08),bluePoint.anchor.x=.65,game.physics.enable(bluePoint,Phaser.Physics.ARCADE),bluePoint.enableBody=!0,blueDestination=game.add.sprite(threadsArray[2]+25,150,"bluePortal"),blueDestination.scale.setTo(.08,.08),blueDestination.anchor.x=.65,numThreads>=4&&(redPoint=game.add.sprite(threadsArray[3]+25,75,"redPortal"),redPoint.animations.add("redPoint",Phaser.Animation.generateFrameNames("Redcheckpoint",1,5,"",1,5),1,!0,!1),redPoint.animations.play("redPoint"),redPoint.scale.setTo(.08,.08),redPoint.anchor.x=.65,game.physics.enable(redPoint,Phaser.Physics.ARCADE),redPoint.enableBody=!0,redDestination=game.add.sprite(threadsArray[1]+25,280,"redPortal"),redDestination.scale.setTo(.08,.08),redDestination.anchor.x=.65),numThreads>=6&&(greenPoint=game.add.sprite(threadsArray[4]+25,60,"greenPortal"),greenPoint.animations.add("greenPoint",Phaser.Animation.generateFrameNames("Greencheckpoint",1,5,"",1,5),4,!0,!1),greenPoint.animations.play("greenPoint"),greenPoint.scale.setTo(.08,.08),greenPoint.anchor.x=.65,game.physics.enable(greenPoint,Phaser.Physics.ARCADE),greenPoint.enableBody=!0,greenDestination=game.add.sprite(threadsArray[5]+25,250,"greenPortal"),greenDestination.scale.setTo(.08,.08),greenDestination.anchor.x=.65),numThreads>=8&&(yellowPoint=game.add.sprite(threadsArray[6]+25,70,"yellowPortal"),yellowPoint.animations.add("yellowPoint",Phaser.Animation.generateFrameNames("YellowCheckpoint",1,5,".png",1,5),5,!0,!1),yellowPoint.animations.play("yellowPoint"),yellowPoint.scale.setTo(.08,.08),yellowPoint.anchor.x=.65,game.physics.enable(yellowPoint,Phaser.Physics.ARCADE),yellowPoint.enableBody=!0,yellowDestination=game.add.sprite(threadsArray[7]+25,200,"yellowPortal"),yellowDestination.scale.setTo(.08,.08),yellowDestination.anchor.x=.65)}function teletrasnportBomb(point,bomb){bomb.x==point.x&&bomb.y>point.y+50&&(Math.random()<LEVEL_PROPABILITY_PORTALS[level-1]?point===bluePoint?(bomb.x=blueDestination.x,bomb.y=blueDestination.y+50,teport.play()):point===redPoint?(bomb.x=redDestination.x,bomb.y=redDestination.y+50,teport.play()):point===greenPoint?(bomb.x=greenDestination.x,bomb.y=greenDestination.y+50,teport.play()):point===yellowPoint&&(bomb.x=yellowDestination.x,bomb.y=yellowDestination.y+50,teport.play()):bomb.x+=.1)}function checkGameB(){level<3&&enemiesDestroyed==LEVEL_ENEMIES[level-1]?(level++,levelText.text="Level: "+level,healthProbability=LEVEL_HEALTH[level-1],lowerDestination(),currentBombProbability=LEVEL_BOMBS_PROBABILITY[level-1],currentBombVelocity=LEVEL_BOMBS_VELOCITY_B[level-1]):3==level&&enemiesDestroyed==LEVEL_ENEMIES[level-1]&&(music.stop(),game.state.start("endScreen"))}function lowerDestination(){blueDestination.y+=20,numThreads>=4&&(redDestination.y+=20),numThreads>=6&&(greenDestination.y+=20),numThreads>=8&&(yellowDestination.y+=20)}let endState={preload:preloadEnd,create:createEnd,update:updatedEnd},enter;function preloadEnd(){game.load.image("background","assets/imgs/Background.png"),game.load.image("back","assets/imgs/button_back.png"),game.load.image("playAgain","assets/imgs/Playagaing.png")}function createEnd(){let bg,color;game.input.enabled=!0,game.add.sprite(0,0,"background").scale.setTo(.5,.5),color="WIN"===result?"#37FF06":"#E10E00";let fontStyle={font:"Press Start 2P",fill:color,align:"center",fontSize:"30px"},resultText=game.add.text(500,175,"YOU "+result,fontStyle);resultText.anchor.setTo(.5,.5);let scoreText=game.add.text(resultText.x,resultText.y+60,"Score: "+score,fontStyle),timeText;scoreText.anchor.setTo(.5,.5),game.add.text(scoreText.x,scoreText.y+60,"Time: "+time,fontStyle).anchor.setTo(.5,.5);let posX=398,posY=313;btnbck=game.add.button(398,513,"back",clickBack);let btnPlayAgain=game.add.image(398,413,"playAgain");enter=game.input.keyboard.addKey(Phaser.Keyboard.ENTER),game.time.events.add(2e4,clickBack,this)}function updatedEnd(){enter.isDown&&(time=0,score=0,result="WIN",game.state.start("partA"))}